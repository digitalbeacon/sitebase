$(document).ready(function(){$.sitebase.debug=false;$.sitebase.init()});(function(a){a.sitebase=new function(){this.debug=false;this.ajaxTimerId1=0;this.ajaxTimerId2=0;this.showMessageSummaryAsModalBox=true;this.localization={culture:"en-US",closeLabel:"Close",messageHeading:"Message",errorHeading:"Oops! Something went wrong...",errorText:"An error occurred while processing this request.",loadingText:"Loading",noDataText:"No content available",confirmText:"Are you sure?",formAlreadySubmitted:"This form has already been submitted. Please refresh this page to attempt this request again."};this.init=function(){this._addSignOutConfirmation();this._initAjaxFeedback();this._setTooltipDefaults();this.displayMessageSummaryAsModalBox();this.addTooltips()};this.log=function(b){a.digitalbeacon.log(b)};this.confirm=function(b){if(b){return confirm(b)}return confirm(this.localization.confirmText)};this.displayMessage=function(f,e,d,c,b){if(!e){e=a.sitebase.localization.messageHeading}var c=c?'<input type="submit" id="ok" class="ok" value="'+c+'" />':"";a.sitebase.modalBox({content:"<h1>"+e+'</h1><div class="message-panel">'+(d?'<div class="'+d+'">':"<div>")+f+"</div>"+c+'<input type="submit" id="close" class="close cancel" value="'+a.sitebase.localization.closeLabel+'" /></div>',success:function(){var g=a("#modalBox input.close:last").click(function(){a.sitebase.closeModalBox()}).keyup(function(h){if(h.keyCode=="27"){return this.click()}});if(c&&b){a("#modalBox input.ok:last").click(function(){b();a.sitebase.closeModalBox()})}setTimeout(function(){g.focus()},100)},replace:false,clickOutsideToClose:true})};this.displayError=function(c,b){if(!b){b=a.sitebase.localization.errorHeading}this.displayMessage(c,b,"error-summary")};this.displayMessageSummaryAsModalBox=function(){if(a.sitebase.showMessageSummaryAsModalBox){var b=a(".message-panel:first");if(b.text()){b.hide();this.displayMessage(b.html())}}};this.checkFormSubmission=function(c){var b=a(c);if(b.data("sumbitted")){a.sb.displayError(a.sitebase.localization.formAlreadySubmitted);return false}else{b.data("sumbitted",true);return true}};this.resetFormSubmission=function(b){a(b).data("sumbitted",false)};this.ajaxSubmit=function(b){if(a.sb.checkFormSubmission(b)){a.post(b.action,a(b).serialize(),function(c){a.sb.modalBox({content:c})})}return false};this.initClientFormValidation=function(b){if(window.mvcClientValidationMetadata){var c={debug:true,highlight:function(d,e){a.sitebase.addTooltips();a(window).resize()},submitHandler:function(d){if(a.sb.checkFormSubmission(d)){d.submit()}}};if(b){c=a.extend(c,b)}a().mvcValidate(window.mvcClientValidationMetadata,c)}};this.addTooltips=function(){a(".form-row-help").each(function(){a(this).show().find(".form-row-tip").bt(a(this).text())});a(".field-validation-error").each(function(){if(a(this).text()){a(this).bt(a(this).text());a(this).text("").css("display","block")}})};this.getRenderPartialUrl=function(b){return a.digitalbeacon.mergeParams(b,{renderType:"partial"})};this.getRenderPartialWrappedUrl=function(b){return a.digitalbeacon.mergeParams(b,{renderType:"partialWrapped"})};this.modalBox=function(b){a.digitalbeacon.modalBox(b)};this.modalBoxOnClose=function(b){a.digitalbeacon.modalBoxOnClose(b)};this.closeModalBox=function(){a.digitalbeacon.closeModalBox()};this.isModalBoxVisible=function(){return a.digitalbeacon.isModalBoxVisible()};this.getModalBox=function(){return a.digitalbeacon.getModalBox()};this.showLoadingModalBox=function(){a.digitalbeacon.showLoadingModalBox()};this.hideLoadingModalBox=function(){a.digitalbeacon.hideLoadingModalBox()};this._setTooltipDefaults=function(){a.bt.options.fill="#fff";a.bt.options.strokeStyle="#000";a.bt.options.spikeLength=15;a.bt.options.spikeGirth=10;a.bt.options.padding=8;a.bt.options.cornerRadius=0;a.bt.options.shadow=true;a.bt.options.shadowColor="rgba(0,0,0,.5)";a.bt.options.shadowBlur=8;a.bt.options.shadowOffsetX=4;a.bt.options.shadowOffsetY=4;a.bt.options.width="300px";a.bt.options.shrinkToFit=true;a.bt.options.hoverIntentOpts={interval:100,timeout:100}};this._addSignOutConfirmation=function(){a('a[href$="signOut"]').click(function(){if(confirm(a(this).text()+"?")){return true}else{return false}})};this._initAjaxFeedback=function(){a.ajaxSetup({cache:false});a("#mask").ajaxStart(function(){var b=a(this);a.sitebase.ajaxTimerId1=setTimeout(function(){b.fadeTo(0,0.01)},250);a.sitebase.ajaxTimerId2=setTimeout(function(){a.sb.showLoadingModalBox()},1000)});a("#mask").ajaxStop(function(){window.clearTimeout(a.sitebase.ajaxTimerId1);window.clearTimeout(a.sitebase.ajaxTimerId2);a(this).fadeOut(0);a.sb.hideLoadingModalBox()});a(document).ajaxComplete(function(c,d,b){if(a.sb.debug){a.sb.log(b.url);a.sb.log(b.data);a.sb.log(d.status);a.sb.log(d.responseText)}});a(document).ajaxError(function(c,e,b,d){a.sb.log(e.status);a.sb.log(e.responseText);if(e.status==403){window.location=window.location}else{a.sb.displayError(a.sitebase.localization.errorText)}})}};a.sb=a.sitebase})(jQuery);var modalboxLocalizedStrings={messageCloseWindow:$.sitebase.localization.closeLabel,messageAjaxLoader:$.sitebase.localization.loadingText,errorMessageIfNoDataAvailable:$.sitebase.localization.noDataText,errorMessageXMLHttpRequest:$.sitebase.localization.errorText,errorMessageTextStatusError:$.sitebase.localization.errorText};$.digitalbeacon.modalBox.defaults.loadingText=$.sitebase.localization.loadingText;$.digitalbeacon.modalBox.defaults.noDataText=$.sitebase.localization.noDataText;